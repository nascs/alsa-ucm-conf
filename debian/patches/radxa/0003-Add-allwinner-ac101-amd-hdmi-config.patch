From 7f5ae1aa9d8bee3b8354ab643eb2033e19475076 Mon Sep 17 00:00:00 2001
From: xzl <xiangzelong@radxa.com>
Date: Thu, 16 Oct 2025 08:54:42 +0000
Subject: [PATCH 1/2] Add allwinner ac101 amd hdmi config

---
 ucm2/Allwinner/ac101/HiFi.conf                | 155 ++++++++++++++++++
 ucm2/Allwinner/hdmi/Hdmi.conf                 |  11 ++
 .../allwinner-ac101/allwinner-ac101.conf      |   8 +
 .../conf.d/allwinner-hdmi/allwinner-hdmi.conf |   8 +
 4 files changed, 182 insertions(+)
 create mode 100644 ucm2/Allwinner/ac101/HiFi.conf
 create mode 100644 ucm2/Allwinner/hdmi/Hdmi.conf
 create mode 100644 ucm2/conf.d/allwinner-ac101/allwinner-ac101.conf
 create mode 100644 ucm2/conf.d/allwinner-hdmi/allwinner-hdmi.conf

diff --git a/ucm2/Allwinner/ac101/HiFi.conf b/ucm2/Allwinner/ac101/HiFi.conf
new file mode 100644
index 0000000..c3d7702
--- /dev/null
+++ b/ucm2/Allwinner/ac101/HiFi.conf
@@ -0,0 +1,155 @@
+SectionVerb {
+	EnableSequence [
+		cset "name='OutputL Mixer DACL Switch' off"
+		cset "name='OutputR Mixer DACR Switch' off"
+		cset "name='LINEOUTL Switch' off"
+		cset "name='LINEOUTR Switch' off"
+		cset "name='SPK Switch' off"
+		cset "name='SPK Volume' 31"
+		cset "name='MIC1 Switch' off"
+		cset "name='MIC2 Switch' off"
+		cset "name='InputL Mixer MIC1 Switch' off"
+		cset "name='InputR Mixer MIC2 Switch' off"
+		cset "name='ADCL Gain' 7"
+		cset "name='ADCR Gain' 7"
+		cset "name='MIC1 Gain' 7"
+		cset "name='MIC2 Gain' 7"
+		cset "name='LINEIN Gain' 7"
+		cset "name='HPOUTL Switch' off"
+		cset "name='HPOUTR Switch' off"
+		cset "name='InputL Mixer LINEIN Switch' off"
+		cset "name='LINEINL Switch' off"
+		cset "name='LINEINR Switch' off"
+		cset "name='ADCL Volume' 160"
+		cset "name='ADCR Volume' 160"
+	]
+}
+
+SectionDevice."Speaker" {
+	Comment "Speaker"
+
+	ConflictingDevice [
+		"Headphones"
+	]
+
+	EnableSequence [
+		cset "name='OutputL Mixer DACL Switch' on"
+		cset "name='OutputR Mixer DACR Switch' on"
+		cset "name='LINEOUTL Switch' on"
+		cset "name='LINEOUTR Switch' on"
+		cset "name='SPK Switch' on"
+		cset "name='SPK Volume' 16"
+	]
+
+	DisableSequence [
+		cset "name='OutputL Mixer DACL Switch' off"
+		cset "name='OutputR Mixer DACR Switch' off"
+		cset "name='LINEOUTL Switch' off"
+		cset "name='LINEOUTR Switch' off"
+		cset "name='SPK Switch' off"
+		cset "name='SPK Volume' 31"
+	]
+
+	Value {
+		PlaybackPriority 100
+		PlaybackPCM "hw:${CardId},0"
+		PlaybackChannels "2"
+	}
+}
+
+SectionDevice."Mic" {
+	Comment "Main Mic"
+
+	ConflictingDevice [
+		"Headset Mic"
+	]
+
+	EnableSequence [
+		cset "name='MIC1 Switch' on"
+		cset "name='MIC2 Switch' on"
+		cset "name='InputL Mixer MIC1 Switch' on"
+		cset "name='InputR Mixer MIC2 Switch' on"
+		cset "name='ADCL Gain' 3"
+		cset "name='ADCR Gain' 3"
+		cset "name='MIC1 Gain' 3"
+		cset "name='MIC2 Gain' 3"
+	]
+
+	DisableSequence [
+		cset "name='MIC1 Switch' off"
+		cset "name='MIC2 Switch' off"
+		cset "name='InputL Mixer MIC1 Switch' off"
+		cset "name='InputR Mixer MIC2 Switch' off"
+		cset "name='ADCL Gain' 7"
+		cset "name='ADCR Gain' 7"
+		cset "name='MIC1 Gain' 7"
+		cset "name='MIC2 Gain' 7"
+	]
+
+	Value {
+		CapturePriority 100
+		CapturePCM "hw:${CardId},0"
+		CaptureChannels "2"
+	}
+}
+
+SectionDevice."Headphones" {
+	Comment "Headphones"
+
+	ConflictingDevice [
+		"Speaker"
+	]
+
+	EnableSequence [
+		cset "name='OutputR Mixer DACR Switch' on"
+		cset "name='OutputL Mixer DACL Switch' on"
+		cset "name='HPOUTL Switch' on"
+		cset "name='HPOUTR Switch' on"
+	]
+
+	DisableSequence [
+		cset "name='OutputR Mixer DACR Switch' off"
+		cset "name='OutputL Mixer DACL Switch' off"
+		cset "name='HPOUTL Switch' off"
+		cset "name='HPOUTR Switch' off"
+	]
+
+	Value {
+		PlaybackVolume "HPOUT Volume"
+		PlaybackPriority 200
+		PlaybackChannels "2"
+		PlaybackPCM "hw:${CardId},0"
+		JackControl "HP Jack"
+	}
+}
+
+SectionDevice."Headset Mic" {
+	Comment "Headset Mic"
+
+	ConflictingDevice [
+		"Mic"
+	]
+
+	EnableSequence [
+		cset "name='InputL Mixer LINEIN Switch' on"
+		cset "name='LINEINL Switch' on"
+		cset "name='LINEINR Switch' on"
+		cset "name='ADCL Volume' 172"
+		cset "name='ADCR Volume' 172"
+	]
+
+	DisableSequence [
+		cset "name='InputL Mixer LINEIN Switch' off"
+		cset "name='LINEINL Switch' off"
+		cset "name='LINEINR Switch' off"
+		cset "name='ADCL Volume' 160"
+		cset "name='ADCR Volume' 160"
+	]
+
+	Value {
+		CapturePriority 200
+		CapturePCM "hw:${CardId},0"
+		CaptureChannels "1"
+		JackControl "HS MIC Jack"
+	}
+}
diff --git a/ucm2/Allwinner/hdmi/Hdmi.conf b/ucm2/Allwinner/hdmi/Hdmi.conf
new file mode 100644
index 0000000..baf6f02
--- /dev/null
+++ b/ucm2/Allwinner/hdmi/Hdmi.conf
@@ -0,0 +1,11 @@
+# Usecase for device HDMI/Display Port stereo playback on allwinner platforms
+# For Audio in I2S mode
+
+SectionDevice."HDMI0" {
+	Comment "HDMI/Display Port Stereo"
+
+	Value {
+		PlaybackPriority 300
+		PlaybackPCM "hw:${CardId}"
+	}
+}
diff --git a/ucm2/conf.d/allwinner-ac101/allwinner-ac101.conf b/ucm2/conf.d/allwinner-ac101/allwinner-ac101.conf
new file mode 100644
index 0000000..a3f1e06
--- /dev/null
+++ b/ucm2/conf.d/allwinner-ac101/allwinner-ac101.conf
@@ -0,0 +1,8 @@
+# UCM for Allwinner H616 Codec
+
+Syntax 2
+
+SectionUseCase."HiFi" {
+	File "/Allwinner/ac101/HiFi.conf"
+	Comment "Play HiFi quality Music"
+}
diff --git a/ucm2/conf.d/allwinner-hdmi/allwinner-hdmi.conf b/ucm2/conf.d/allwinner-hdmi/allwinner-hdmi.conf
new file mode 100644
index 0000000..e2bd500
--- /dev/null
+++ b/ucm2/conf.d/allwinner-hdmi/allwinner-hdmi.conf
@@ -0,0 +1,8 @@
+Syntax 2
+
+Comment "Allwinner HDMI card"
+
+SectionUseCase."HDMI" {
+	File "/Allwinner/hdmi/Hdmi.conf"
+	Comment "HDMI/Display Port Stereo"
+}
-- 
2.43.0

